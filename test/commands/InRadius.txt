InRadius1_2D
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 1 ] of patch 0 0 => 5
  [ count patches in-radius 1 ] of patch -3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 5
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 5
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false false
  [ count patches in-radius 1 ] of patch 0 0 => 5
  [ count patches in-radius 1 ] of patch -3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 3
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false true
  [ count patches in-radius 1 ] of patch 0 0 => 5
  [ count patches in-radius 1 ] of patch -3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 4
  [ count patches in-radius 1 ] of patch 0 max-pycor => 5
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 4
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology true false
  [ count patches in-radius 1 ] of patch 0 0 => 5
  [ count patches in-radius 1 ] of patch -3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 5
  [ count patches in-radius 1 ] of patch 0 max-pycor => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 4
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0

InRadius2_2D
  O> resize-world 0 10 0 10
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 1 ] of patch 0 0 => 5
  [ count patches in-radius 1 ] of patch -3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 5
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 5
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false false
  [ count patches in-radius 1 ] of patch 0 0 => 3
  [ count patches in-radius 1 ] of patch 3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 3 => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 3
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false true
  [ count patches in-radius 1 ] of patch 0 0 => 4
  [ count patches in-radius 1 ] of patch 3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 3 => 4
  [ count patches in-radius 1 ] of patch 0 max-pycor => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 4
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology true false
  [ count patches in-radius 1 ] of patch 0 0 => 4
  [ count patches in-radius 1 ] of patch 3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 4
  [ count patches in-radius 1 ] of patch 0 max-pycor => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 4
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0

InRadius3_2D
  O> resize-world 0 11 0 11
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 1 ] of patch 0 0 => 5
  [ count patches in-radius 1 ] of patch -3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 5
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 5
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false false
  [ count patches in-radius 1 ] of patch 0 0 => 3
  [ count patches in-radius 1 ] of patch 3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 3 => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 3
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false true
  [ count patches in-radius 1 ] of patch 0 0 => 4
  [ count patches in-radius 1 ] of patch 3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 3 => 4
  [ count patches in-radius 1 ] of patch 0 max-pycor => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 4
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology true false
  [ count patches in-radius 1 ] of patch 0 0 => 4
  [ count patches in-radius 1 ] of patch 3 4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 4
  [ count patches in-radius 1 ] of patch 0 max-pycor => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 4
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0

InRadius4_2D
  O> resize-world -10 0 -10 0
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 1 ] of patch 0 0 => 5
  [ count patches in-radius 1 ] of patch -3 -4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 5
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 5
  [ count turtles in-radius 1 ] of patch -10 -10 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology false false
  [ count patches in-radius 1 ] of patch 0 0 => 3
  [ count patches in-radius 1 ] of patch -3 -4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor -3 => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 3
  [ count turtles in-radius 1 ] of patch -10 -10 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology false true
  [ count patches in-radius 1 ] of patch 0 0 => 4
  [ count patches in-radius 1 ] of patch -3 -4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor -3 => 4
  [ count patches in-radius 1 ] of patch 0 max-pycor => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 4
  [ count turtles in-radius 1 ] of patch -10 -10 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology true false
  [ count patches in-radius 1 ] of patch 0 0 => 4
  [ count patches in-radius 1 ] of patch -3 -4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 4
  [ count patches in-radius 1 ] of patch 0 max-pycor => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 4
  [ count turtles in-radius 1 ] of patch -10 -10 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10

InRadius5_2D
  O> resize-world -11 0 -11 0
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 1 ] of patch 0 0 => 5
  [ count patches in-radius 1 ] of patch -3 -4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 5
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 5
  [ count turtles in-radius 1 ] of patch -11 -11 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology false false
  [ count patches in-radius 1 ] of patch 0 0 => 3
  [ count patches in-radius 1 ] of patch -3 -4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor -3 => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 3
  [ count turtles in-radius 1 ] of patch -11 -11 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology false true
  [ count patches in-radius 1 ] of patch 0 0 => 4
  [ count patches in-radius 1 ] of patch -3 -4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor -3 => 4
  [ count patches in-radius 1 ] of patch 0 max-pycor => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 4
  [ count turtles in-radius 1 ] of patch -11 -11 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology true false
  [ count patches in-radius 1 ] of patch 0 0 => 4
  [ count patches in-radius 1 ] of patch -3 -4 => 5
  [ count patches in-radius 1 ] of patch max-pxcor 0 => 4
  [ count patches in-radius 1 ] of patch 0 max-pycor => 4
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor => 4
  [ count turtles in-radius 1 ] of patch -11 -11 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10

InRadius6_2D
  O> resize-world 0 5 0 5
  O> create-turtles 10
  O> __change-topology true true
  [ count turtles in-radius 2 ] of patch 5 5 => 10
  [ count turtles in-radius 2 ] of patch 0 5 => 10
  [ count turtles in-radius 2 ] of patch 5 0 => 10
  [ count turtles in-radius 2 ] of patch 4 4 => 0
  [ count turtles in-radius 2 ] of patch 1 1 => 10
  O> __change-topology false false
  [ count turtles in-radius 2 ] of patch 5 5 => 0
  [ count turtles in-radius 2 ] of patch 0 5 => 0
  [ count turtles in-radius 2 ] of patch 5 0 => 0
  [ count turtles in-radius 2 ] of patch 4 4 => 0
  [ count turtles in-radius 2 ] of patch 1 1 => 10
  O> resize-world 0 3 0 3
  O> create-turtles 10
  O> __change-topology true true
  [ count turtles in-radius 2 ] of patch 3 3 => 10
  [ count turtles in-radius 1 ] of patch 0 3 => 10
  [ count turtles in-radius 1 ] of patch 3 0 => 10
  [ count turtles in-radius 1 ] of patch 2 2 => 0
    O> __change-topology false false
  [ count turtles in-radius 2 ] of patch 3 3 => 0
  [ count turtles in-radius 1 ] of patch 0 3 => 0
  [ count turtles in-radius 1 ] of patch 3 0 => 0
  [ count turtles in-radius 1 ] of patch 2 2 => 0
  [ count turtles in-radius 1 ] of patch 0 0 => 10

InRadius7_2D
  O> resize-world -16 16 -16 16
  O> __change-topology true true
  O> crt 1 [ setxy -4.998332335 -6.121246053 ]
  O> crt 1 [ setxy -7.503291252 -5.746270605 ]
  [ count turtles in-radius 2.6088790696389133 ] of turtle 0 => 2

InRadius1_3D
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 1 ] of patch 0 0 0 => 7
  [ count patches in-radius 1 ] of patch -3 4 0 => 7
  [ count patches in-radius 1 ] of patch max-pxcor 0 0 => 7
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor 0 => 7
  [ count turtles in-radius 1 ] of patch 0 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor 0 => 0

InRadius2_3D
  globals [ glob1 ]
  breed [frogs frog]
  O> create-frogs 100 [ setxy random-xcor random-ycor set color red ]
  O> set glob1 [ count turtles in-radius 3] of turtle 0
  glob1 = [ count turtles with [ color = red ] in-radius 3 ] of turtle 0 => true
  glob1 = [ count turtles with [ color = red ] in-radius 3 ] of turtle 0 => true

InRadius3_3D
  O> resize-world 0 11 0 11 0 11
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 1 ] of patch 0 0 0 => 7
  [ count patches in-radius 1 ] of patch -3 4 0 => 7
  [ count patches in-radius 1 ] of patch max-pxcor 0 0 => 7
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor 0 => 7
  [ count turtles in-radius 1 ] of patch 0 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor 11 => 0

InRadius4_3D
  O> resize-world -10 0 -10 0 -10 0
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 1 ] of patch 0 0 0 => 7
  [ count patches in-radius 1 ] of patch -3 -4 0 => 7
  [ count patches in-radius 1 ] of patch max-pxcor 0 0 => 7
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor 0 => 7
  [ count turtles in-radius 1 ] of patch -10 -10 -10 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor 0 => 10

InRadius5_3D
  O> resize-world -11 0 -11 0 -11 0
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 1 ] of patch 0 0 0 => 7
  [ count patches in-radius 1 ] of patch -3 -4 0 => 7
  [ count patches in-radius 1 ] of patch max-pxcor 0 0 => 7
  [ count patches in-radius 1 ] of patch max-pxcor max-pycor 0 => 7
  [ count turtles in-radius 1 ] of patch -11 -11 0 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor 0 => 10

InRadiusLargeRadius1_2D
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 14 ] of patch 0 0 => 121
  [ count patches in-radius 14 ] of patch -3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 121
  [ count patches in-radius 14 ] of patch 0 min-pycor => 121
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false false
  [ count patches in-radius 14 ] of patch 0 0 => 121
  [ count patches in-radius 14 ] of patch -3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 121
  [ count patches in-radius 14 ] of patch 0 min-pycor => 121
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology true false
  [ count patches in-radius 14 ] of patch 0 0 => 121
  [ count patches in-radius 14 ] of patch -3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 121
  [ count patches in-radius 14 ] of patch 0 min-pycor => 121
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false true
  [ count patches in-radius 14 ] of patch 0 0 => 121
  [ count patches in-radius 14 ] of patch -3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 121
  [ count patches in-radius 14 ] of patch 0 min-pycor => 121
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0

InRadiusLargeRadius2_2D
  O> resize-world 0 10 0 10
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 14 ] of patch 0 0 => 121
  [ count patches in-radius 14 ] of patch 3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 121
  [ count patches in-radius 14 ] of patch 0 min-pycor => 121
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false false
  [ count patches in-radius 14 ] of patch 0 0 => 120
  [ count patches in-radius 14 ] of patch 3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 120
  [ count patches in-radius 14 ] of patch 0 min-pycor => 120
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology true false
  [ count patches in-radius 14 ] of patch 0 0 => 121
  [ count patches in-radius 14 ] of patch 3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 121
  [ count patches in-radius 14 ] of patch 0 min-pycor => 121
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false true
  [ count patches in-radius 14 ] of patch 0 0 => 121
  [ count patches in-radius 14 ] of patch 3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 121
  [ count patches in-radius 14 ] of patch 0 min-pycor => 121
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0

InRadiusLargeRadius3_2D
  O> resize-world 0 11 0 11
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 14 ] of patch 0 0 => 144
  [ count patches in-radius 14 ] of patch 3 0 => 144
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 144
  [ count patches in-radius 14 ] of patch 0 min-pycor => 144
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false false
  [ count patches in-radius 16 ] of patch 0 0 => 144
  [ count patches in-radius 16 ] of patch 3 0 => 144
  [ count patches in-radius 16 ] of patch max-pxcor 0 => 144
  [ count patches in-radius 16 ] of patch 0 min-pycor => 144
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology true false
  [ count patches in-radius 16 ] of patch 0 0 => 144
  [ count patches in-radius 16 ] of patch 3 0 => 144
  [ count patches in-radius 16 ] of patch max-pxcor 0 => 144
  [ count patches in-radius 16 ] of patch 0 min-pycor => 144
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0
  O> __change-topology false true
  [ count patches in-radius 16 ] of patch 0 0 => 144
  [ count patches in-radius 16 ] of patch 3 0 => 144
  [ count patches in-radius 16 ] of patch max-pxcor 0 => 144
  [ count patches in-radius 16 ] of patch 0 min-pycor => 144
  [ count turtles in-radius 1 ] of patch 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 0

InRadiusLargeRadius4_2D
  O> resize-world -10 0 -10 0
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 14 ] of patch 0 0 => 121
  [ count patches in-radius 14 ] of patch -3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 121
  [ count patches in-radius 14 ] of patch 0 min-pycor => 121
  [ count patches in-radius 2 ] of patch 0 0 => 13
  [ count patches in-radius 2 ] of patch -3 0 => 13
  [ count patches in-radius 2 ] of patch max-pxcor 0 => 13
  [ count patches in-radius 2 ] of patch 0 min-pycor => 13
  [ count turtles in-radius 1 ] of patch -10 -10 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology false false
  [ count patches in-radius 14 ] of patch 0 0 => 120
  [ count patches in-radius 14 ] of patch -3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 120
  [ count patches in-radius 14 ] of patch 0 min-pycor => 120
  [ count patches in-radius 2 ] of patch 0 0 => 6
  [ count patches in-radius 2 ] of patch -3 0 => 9
  [ count patches in-radius 2 ] of patch max-pxcor 0 => 6
  [ count patches in-radius 2 ] of patch 0 min-pycor => 6
  [ count turtles in-radius 1 ] of patch -10 -10 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology true false
  [ count patches in-radius 14 ] of patch 0 0 => 121
  [ count patches in-radius 14 ] of patch -3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 121
  [ count patches in-radius 14 ] of patch 0 min-pycor => 121
  [ count patches in-radius 2 ] of patch 0 0 => 9
  [ count patches in-radius 2 ] of patch -3 0 => 9
  [ count patches in-radius 2 ] of patch max-pxcor 0 => 9
  [ count patches in-radius 2 ] of patch 0 min-pycor => 9
  [ count turtles in-radius 1 ] of patch -10 -10 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology false true
  [ count patches in-radius 14 ] of patch 0 0 => 121
  [ count patches in-radius 14 ] of patch -3 0 => 121
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 121
  [ count patches in-radius 14 ] of patch 0 min-pycor => 121
  [ count patches in-radius 2 ] of patch 0 0 => 9
  [ count patches in-radius 2 ] of patch -3 0 => 13
  [ count patches in-radius 2 ] of patch max-pxcor 0 => 9
  [ count patches in-radius 2 ] of patch 0 min-pycor => 9
  [ count turtles in-radius 1 ] of patch -10 -10 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10

InRadiusLargeRadius5_2D
  O> resize-world -11 0 -11 0
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 14 ] of patch 0 0 => 144
  [ count patches in-radius 14 ] of patch -3 0 => 144
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 144
  [ count patches in-radius 14 ] of patch 0 min-pycor => 144
  [ count turtles in-radius 1 ] of patch -11 -11 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology false false
  [ count patches in-radius 14 ] of patch 0 0 => 138
  [ count patches in-radius 14 ] of patch -3 0 => 144
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 138
  [ count patches in-radius 14 ] of patch 0 min-pycor => 138
  [ count turtles in-radius 1 ] of patch -11 -11 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology true false
  [ count patches in-radius 14 ] of patch 0 0 => 144
  [ count patches in-radius 14 ] of patch -3 0 => 144
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 144
  [ count patches in-radius 14 ] of patch 0 min-pycor => 144
  [ count turtles in-radius 1 ] of patch -11 -11 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10
  O> __change-topology false true
  [ count patches in-radius 14 ] of patch 0 0 => 144
  [ count patches in-radius 14 ] of patch -3 0 => 144
  [ count patches in-radius 14 ] of patch max-pxcor 0 => 144
  [ count patches in-radius 14 ] of patch 0 min-pycor => 144
  [ count turtles in-radius 1 ] of patch -11 -11 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor => 10

InRadiusLargeRadius1_3D
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 14 ] of patch 0 0 0 => 1331
  [ count patches in-radius 14 ] of patch -3 0 0 => 1331
  [ count patches in-radius 14 ] of patch max-pxcor 0 0 => 1331
  [ count patches in-radius 14 ] of patch 0 min-pycor 0 => 1331
  [ count turtles in-radius 1 ] of patch 0 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor 0 => 0

InRadiusLargeRadius2_3D
  O> resize-world 0 10 0 10 0 10
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 14 ] of patch 0 0 0 => 1331
  [ count patches in-radius 14 ] of patch 3 0 0 => 1331
  [ count patches in-radius 14 ] of patch max-pxcor 0 0 => 1331
  [ count patches in-radius 14 ] of patch 0 min-pycor 0 => 1331
  [ count turtles in-radius 1 ] of patch 0 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor 0 => 0

InRadiusLargeRadius3_3D
  O> resize-world 0 11 0 11 0 11
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 14 ] of patch 0 0 0 => 1728
  [ count patches in-radius 14 ] of patch 3 0 0 => 1728
  [ count patches in-radius 14 ] of patch max-pxcor 0 0 => 1728
  [ count patches in-radius 14 ] of patch 0 min-pycor 0 => 1728
  [ count turtles in-radius 1 ] of patch 0 0 0 => 10
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor 0 => 0

InRadiusLargeRadius4_3D
  O> resize-world -10 0 -10 0 -10 0
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 14 ] of patch 0 0 0 => 1331
  [ count patches in-radius 14 ] of patch -3 0 0 => 1331
  [ count patches in-radius 14 ] of patch max-pxcor 0 0 => 1331
  [ count patches in-radius 14 ] of patch 0 min-pycor 0 => 1331
  [ count turtles in-radius 1 ] of patch -10 -10 -10 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor 0 => 10

InRadiusLargeRadius5_3D
  O> resize-world -11 0 -11 0 -11 0
  O> create-turtles 10
  O> __change-topology true true
  [ count patches in-radius 14 ] of patch 0 0 0 => 1728
  [ count patches in-radius 14 ] of patch -3 0 0 => 1728
  [ count patches in-radius 14 ] of patch max-pxcor 0 0 => 1728
  [ count patches in-radius 14 ] of patch 0 min-pycor 0 => 1728
  [ count turtles in-radius 1 ] of patch -11 -11 -11 => 0
  [ count turtles in-radius 1 ] of patch max-pxcor max-pycor 0 => 10

InRadius_Unwrapped_OppositeCorners1_2D
  O> resize-world -50 50 -50 50
  O> __change-topology false false
  O> create-turtles 1 [ setxy -48 -48 ]
  O> create-turtles 1 [ setxy 48 48 ]
  [ distance turtle 1 ] of turtle 0 => 135.7645019878171
  O> ask turtles [ create-links-with other turtles in-radius 100.5 ]
  count links => 0
  [ count other turtles in-radius 1 ] of turtle 0 => 0
  [ count other turtles in-radius 2 ] of turtle 0 => 0
  [ count other turtles in-radius 30 ] of turtle 0 => 0
  [ count other turtles in-radius 95 ] of turtle 0 => 0
  [ count other turtles in-radius 96 ] of turtle 0 => 0

InRadius_Unwrapped_OppositeCorners2_2D
  O> resize-world -50 50 -50 50
  O> __change-topology false false
  O> create-turtles 1 [ setxy 48 -48 ]
  O> create-turtles 1 [ setxy -48 48 ]
  [ distance turtle 1 ] of turtle 0 => 135.7645019878171
  O> ask turtles [ create-links-with other turtles in-radius 100.5 ]
  count links => 0
  [ count other turtles in-radius 1 ] of turtle 0 => 0
  [ count other turtles in-radius 2 ] of turtle 0 => 0
  [ count other turtles in-radius 30 ] of turtle 0 => 0
  [ count other turtles in-radius 95 ] of turtle 0 => 0
  [ count other turtles in-radius 96 ] of turtle 0 => 0

InRadius_With_Changing_World_2D
  O> resize-world -16 16 -16 16
  O> __change-topology true true
  O> create-turtles 2 [ fd 15 ]
  O> ask one-of turtles [ ask turtles in-radius 100 [ set color blue ] ]
  O> resize-world -50 50 -50 50
  O> __change-topology false false
  O> create-turtles 2 [ fd 15 ]
  O> ask one-of turtles [ ask turtles in-radius 100 [ set color green ] ]
  count turtles with [ color = green ] => 2

InRadius_Wrapping_Checks_Wide_2D
  O> resize-world -6 6 -4 4
  O> __change-topology true true
  count [ patches in-radius 5 ] of (patch -3 2) => 79
  count [ patches in-radius 5 ] of (patch 3 2) => 79
  count [ patches in-radius 5 ] of (patch 3 -2) => 79
  count [ patches in-radius 5 ] of (patch -3 -2) => 79
  O> __change-topology true false
  count [ patches in-radius 5 ] of (patch -3 2) => 64
  count [ patches in-radius 5 ] of (patch 3 2) => 64
  count [ patches in-radius 5 ] of (patch 3 -2) => 64
  count [ patches in-radius 5 ] of (patch -3 -2) => 64
  O> __change-topology false true
  count [ patches in-radius 5 ] of (patch -3 2) => 71
  count [ patches in-radius 5 ] of (patch 3 2) => 71
  count [ patches in-radius 5 ] of (patch 3 -2) => 71
  count [ patches in-radius 5 ] of (patch -3 -2) => 71
  O> __change-topology false false
  count [ patches in-radius 5 ] of (patch -3 2) => 57
  count [ patches in-radius 5 ] of (patch 3 2) => 57
  count [ patches in-radius 5 ] of (patch 3 -2) => 57
  count [ patches in-radius 5 ] of (patch -3 -2) => 57

InRadius_Wrapping_Checks_Tall_2D
  O> resize-world -4 4 -6 6
  O> __change-topology true true
  count [ patches in-radius 5 ] of (patch -2 3) => 79
  count [ patches in-radius 5 ] of (patch 2 3) => 79
  count [ patches in-radius 5 ] of (patch 2 -3) => 79
  count [ patches in-radius 5 ] of (patch -2 -3) => 79
  O> __change-topology true false
  count [ patches in-radius 5 ] of (patch -2 3) => 71
  count [ patches in-radius 5 ] of (patch 2 3) => 71
  count [ patches in-radius 5 ] of (patch 2 -3) => 71
  count [ patches in-radius 5 ] of (patch -2 -3) => 71
  O> __change-topology false true
  count [ patches in-radius 5 ] of (patch -2 3) => 64
  count [ patches in-radius 5 ] of (patch 2 3) => 64
  count [ patches in-radius 5 ] of (patch 2 -3) => 64
  count [ patches in-radius 5 ] of (patch -2 -3) => 64
  O> __change-topology false false
  count [ patches in-radius 5 ] of (patch -2 3) => 57
  count [ patches in-radius 5 ] of (patch 2 3) => 57
  count [ patches in-radius 5 ] of (patch 2 -3) => 57
  count [ patches in-radius 5 ] of (patch -2 -3) => 57

# In an attempt to verify in general if there are any problems with `in-radius`,
# we run a bunch of world topology combinations with a bunch of random agents
# and radii against the naive/slow NetLogo code implementation.
# -Jeremy B July 15th

InRadius_Sanity_Patches_2D
  globals [ radius p wrap-x wrap-y test-count ]
  to assert [ expression ] if ( not expression ) [ error (word "Assertion failed, max-pxcor: " max-pxcor ", max-pycor: " max-pycor ", wrap (X,Y): (" wrap-x "," wrap-y "), patch: " p ", radius: " radius) ] end
  to-report temp-in-radius [agentset r] report (agentset with [ distance myself <= r ]) end
  to run-test [ test-patch r ] set test-count (test-count + 1) set p test-patch set radius r assert [ patches in-radius radius = temp-in-radius patches radius ] of test-patch end
  to run-tests repeat 100 [ foreach [ 0.5 1 1.5 2 2.5 9 20 22 48 99 100 ] [ r -> run-test one-of patches r ] ] end
  to set-world [x y wx wy] set wrap-x wx set wrap-y wy resize-world (-1 * x) x (-1 * y) y __change-topology wrap-x wrap-y end
  O> assert [ patches in-radius 5 = temp-in-radius patches 5 ] of patch 0 0
  O> foreach [true false] [ wx -> foreach [true false] [ wy -> foreach [1 2 10 50] [ x -> foreach [1 2 10 50] [ y -> set-world x y wx wy run-tests ] ] ] ]
  test-count => 70400

InRadius_Sanity_Turtles_2D
  globals [ radius t wrap-x wrap-y test-count ]
  to assert [ expression ] if ( not expression ) [ error (word "Assertion failed, max-pxcor: " max-pxcor ", max-pycor: " max-pycor ", wrap (X,Y): (" wrap-x "," wrap-y "), turtle: " t " at (" [xcor] of t ", " [ycor] of t "), radius: " radius) ] end
  to-report temp-in-radius [agentset r] report (agentset with [ distance myself <= r ]) end
  to run-test [ test-turtle r ] set test-count (test-count + 1) set t test-turtle set radius r assert [ turtles in-radius radius = temp-in-radius turtles radius ] of test-turtle end
  to run-tests repeat 100 [ foreach [ 0.5 1 1.5 2 2.5 9 20 22 48 99 100 ] [ r -> run-test (one-of turtles) r ] ] end
  to set-world [x y wx wy] set wrap-x wx set wrap-y wy resize-world (-1 * x) x (-1 * y) y __change-topology wrap-x wrap-y clear-turtles create-turtles 100 [ set xcor random-xcor set ycor random-ycor ] end
  O> foreach [true false] [ wx -> foreach [true false] [ wy -> foreach [1 2 10 50] [ x -> foreach [1 2 10 50] [ y -> set-world x y wx wy run-tests ] ] ] ]
  test-count => 70400
